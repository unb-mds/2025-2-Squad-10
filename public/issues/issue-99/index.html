<!DOCTYPE html>
<html lang="pt-br">
<head><script src="/2025-2-OncoMap/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=2025-2-OncoMap/livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>
        
            [FEATURE] Fazendo a integra√ß√£o do frontend e do backend | OncoMap
        
    </title>
    

    
    
    
    
    
    
    
    
    
    
    
        
        
    

    
    
    
    
    
    
    
    
    
    
    <link rel="stylesheet" href="http://localhost:1313/2025-2-OncoMap/css/issues-page-bundle.min.css">



</head>
<body>

    <nav class="navbar">

    <a class="navbar-brand" href="http://localhost:1313/2025-2-OncoMap/">
        OncoMap
    </a>

    <ul class="navbar-links">
        <li><a href="http://localhost:1313/2025-2-OncoMap/">In√≠cio</a></li>
        <li><a href="http://localhost:1313/2025-2-OncoMap/sprints/">Sprints</a></li>
        <li><a href="http://localhost:1313/2025-2-OncoMap/requisitos/">Requisitos</a></li>
        <li><a href="http://localhost:1313/2025-2-OncoMap/arquitetura/">Arquitetura</a></li>
        <li><a href="http://localhost:1313/2025-2-OncoMap/diversos/">Diversos</a></li>
        <li><a href="http://localhost:1313/2025-2-OncoMap/doc/">Documenta√ß√£o</a></li>
    </ul>

    <div class="navbar-right">
        <a href="https://github.com/unb-mds/2025-2-OncoMap" target="_blank">GitHub</a>
    </div>

</nav>

    <section class="hero">
    <div class="container">
        <h1>[FEATURE] Fazendo a integra√ß√£o do frontend e do backend</h1>
        
        
        
        </div>
</section>

    <main>
        

    <div class="container page-single">
        <h1>[FEATURE] Fazendo a integra√ß√£o do frontend e do backend</h1>
        
        <div class="content">
            <h2 id="-descri√ß√£o">üéØ Descri√ß√£o</h2>
<p>Implementa√ß√£o completa da integra√ß√£o Frontend-Backend para visualiza√ß√£o hier√°rquica de dados (Regi√£o ‚Üí Estado ‚Üí Munic√≠pio) e gera√ß√£o de relat√≥rios PDF detalhados com intelig√™ncia artificial. O sistema agora consome dados reais do banco PostgreSQL, permitindo navega√ß√£o &ldquo;drill-down&rdquo; no mapa e na tabela lateral, al√©m de oferecer feedback visual de carregamento e downloads de relat√≥rios anuais.</p>
<hr>
<h2 id="-objetivo">‚úÖ Objetivo</h2>
<p>Esta feature resolve a desconex√£o entre a interface do mapa e os dados reais coletados pelos scripts de IA.</p>
<p><strong>Principais melhorias:</strong></p>
<ol>
<li><strong>Visualiza√ß√£o Granular:</strong> Permite ao usu√°rio ver desde o macro (Total da Regi√£o) at√© o micro (Gastos com medicamentos em um munic√≠pio espec√≠fico por ano).</li>
<li><strong>Relat√≥rios Inteligentes:</strong> Substitui√ß√£o de PDFs est√°ticos por documentos gerados via <strong>Google Gemini</strong>, contendo an√°lises qualitativas e tabelas consolidadas por ano.</li>
<li><strong>Experi√™ncia do Usu√°rio (UX):</strong> Corre√ß√£o de bugs visuais (n√∫meros vazando, pesquisa quebrada) e implementa√ß√£o de feedbacks de carregamento (Spinner no mapa e aba de processamento para PDFs).</li>
</ol>
<hr>
<h2 id="-detalhes-da-implementa√ß√£o">üìù Detalhes da Implementa√ß√£o</h2>
<h3 id="backend-nodejsexpress">Backend (Node.js/Express)</h3>
<ul>
<li><strong>Rotas de Mapa (<code>src/api/routes/mapRoutes.js</code>):</strong>
<ul>
<li>Cria√ß√£o de endpoints hier√°rquicos:
<ul>
<li><code>GET /regiao/:regiaoSlug</code>: Retorna totais da regi√£o e lista de estados agrupados.</li>
<li><code>GET /estado/:codIbge</code>: Retorna totais do estado, categorias agregadas e lista de munic√≠pios.</li>
<li><code>GET /municipio/:ibge</code>: Retorna detalhes profundos (categorias, lista de di√°rios e links originais).</li>
</ul>
</li>
<li>Ajuste nas queries SQL para somar valores de PDF (<code>extracted_value</code>) e TXT (<code>extracted_value_txt</code>).</li>
</ul>
</li>
<li><strong>Controller de Relat√≥rios (<code>src/api/controllers/reportController.js</code>):</strong>
<ul>
<li>Implementa√ß√£o de l√≥gica de agrupamento temporal (Ano a Ano).</li>
<li>Cria√ß√£o de prompts espec√≠ficos para o Gemini gerar HTML estruturado para Regi√£o, Estado e Munic√≠pio.</li>
<li>Configura√ß√£o do rodap√© fixo e margens no <code>html-pdf-node</code>.</li>
</ul>
</li>
</ul>
<h3 id="frontend-reacttypescript">Frontend (React/TypeScript)</h3>
<ul>
<li><strong>Servi√ßos (<code>src/services/mapService.ts</code>):</strong>
<ul>
<li>Adi√ß√£o de m√©todos tipados (<code>getDetalhesEstado</code>, <code>getDetalhesMunicipio</code>) para consumir as novas rotas.</li>
</ul>
</li>
<li><strong>Componente de Tabela (<code>src/components/MapaPage/TabelaInfo.tsx</code>):</strong>
<ul>
<li>Refatora√ß√£o total para suportar 3 n√≠veis de navega√ß√£o.</li>
<li>Implementa√ß√£o de filtro de busca local na tabela de munic√≠pios.</li>
<li>Corre√ß√£o de bug no clique da linha da tabela (uso correto do <code>codarea</code>).</li>
</ul>
</li>
<li><strong>Novo Componente (<code>src/components/Geral/PdfButton.tsx</code>):</strong>
<ul>
<li>Cria√ß√£o de bot√£o isolado que gerencia o fluxo de download: <em>Abre aba de carregamento -&gt; Aguarda Backend -&gt; For√ßa Download -&gt; Fecha aba automaticamente</em>.</li>
</ul>
</li>
<li><strong>Mapa Interativo (<code>src/components/MapaPage/mapa.tsx</code>):</strong>
<ul>
<li>Adi√ß√£o de Overlay de &ldquo;Carregando Mapa&hellip;&rdquo; ao iniciar a aplica√ß√£o e ao carregar GeoJSONs pesados de munic√≠pios.</li>
</ul>
</li>
<li><strong>Estiliza√ß√£o (<code>src/style/Tabelainfo.css</code>):</strong>
<ul>
<li>Aplica√ß√£o do tema <strong>Dark/Verde</strong> nos detalhes do estado (removido fundo branco).</li>
<li>Corre√ß√£o de quebra de layout para n√∫meros financeiros grandes (<code>word-wrap</code>).</li>
<li>Fixa√ß√£o do posicionamento da lista de sugest√µes da pesquisa (<code>position: absolute</code>).</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-crit√©rios-de-aceita√ß√£o">üìä Crit√©rios de Aceita√ß√£o</h2>
<h3 id="funcionalidades-de-dados">Funcionalidades de Dados</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> Ao clicar na <strong>Regi√£o</strong>, exibe o total acumulado e lista de Estados.</li>
<li><input checked="" disabled="" type="checkbox"> Ao clicar no <strong>Estado</strong>, exibe o total do estado, cards com categorias somadas e lista de Munic√≠pios.</li>
<li><input checked="" disabled="" type="checkbox"> Ao clicar no <strong>Munic√≠pio</strong> (via mapa ou tabela), exibe detalhes profundos: categorias, valores e lista de links para os di√°rios oficiais.</li>
<li><input checked="" disabled="" type="checkbox"> A pesquisa de munic√≠pio filtra a tabela corretamente e permite clique para ver detalhes.</li>
</ul>
<h3 id="gera√ß√£o-de-relat√≥rios-pdf">Gera√ß√£o de Relat√≥rios (PDF)</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> O bot√£o de PDF gera um relat√≥rio contextualizado (Regi√£o, Estado ou Munic√≠pio).</li>
<li><input checked="" disabled="" type="checkbox"> O PDF cont√©m detalhamento hist√≥rico <strong>Ano a Ano</strong>.</li>
<li><input checked="" disabled="" type="checkbox"> O PDF inclui tabelas de categorias e tabelas geogr√°ficas em cada se√ß√£o anual.</li>
<li><input checked="" disabled="" type="checkbox"> O download n√£o √© bloqueado pelo navegador (fluxo de nova aba tempor√°ria implementado).</li>
</ul>
<h3 id="interface-uiux">Interface (UI/UX)</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> Spinner de carregamento aparece ao baixar fronteiras de munic√≠pios no mapa.</li>
<li><input checked="" disabled="" type="checkbox"> Layout da tabela segue o tema escuro/verde, sem caixas brancas ileg√≠veis.</li>
<li><input checked="" disabled="" type="checkbox"> Valores monet√°rios grandes (bilh√µes) n√£o quebram o layout dos cards.</li>
<li><input checked="" disabled="" type="checkbox"> Lista de autocomplete da pesquisa aparece logo abaixo do input, sem deslocamento.</li>
</ul>

        </div>
    </div>


    </main>

    <footer class="footer">
    <div class="container">
        <div class="footer-grid">
            
            <div class="footer-column about">
                <h3>OncoMap</h3>
                <p>Mapa de investimento em sa√∫de oncol√≥gica</p>
            </div>
            
            <div class="footer-column links">
                <h3>Links √öteis</h3>
                <ul>
                    <li><a href="http://localhost:1313/2025-2-OncoMap/">In√≠cio</a></li>
                    <li><a href="http://localhost:1313/2025-2-OncoMap/sprints">Sprints</a></li>
                    
                    
                    
                    
                        <li><a href="http://localhost:1313/2025-2-OncoMap/requisitos/">Requisitos</a></li>
                    
                    
                    
                    
                        <li><a href="http://localhost:1313/2025-2-OncoMap/arquitetura/">Arquitetura</a></li>
                    
                </ul>
            </div>
            
            <div class="footer-column contact">
                <h3>Contato</h3>
                <ul>
                    <li><a href="https://github.com/unb-mds/2025-2-OncoMap" target="_blank">GitHub</a></li>
                </ul>
            </div>

        </div>
    </div>
    
    <div class="footer-bottom">
        <div class="container">
            <p>&copy; 2025 OncoMap. Todos os direitos reservados.</p>
            <p>Desenvolvido pela equipe UnB-MDS</p>
        </div>
    </div>
</footer>
    
    <script src="http://localhost:1313/2025-2-OncoMap/js/app.js"></script>
</body>
</html>