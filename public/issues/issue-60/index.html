<!DOCTYPE html>
<html lang="pt-br">
<head><script src="/2025-2-OncoMap/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=2025-2-OncoMap/livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>
        
            [FEATURE] Alimentacao do municipalities_status | OncoMap
        
    </title>
    

    
    
    
    
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
    <link rel="stylesheet" href="http://localhost:1313/2025-2-OncoMap/css/issues-page-bundle.min.css">



</head>
<body>

    <nav class="navbar">

    <a class="navbar-brand" href="http://localhost:1313/2025-2-OncoMap/">
        OncoMap
    </a>

    <ul class="navbar-links">
        <li><a href="http://localhost:1313/2025-2-OncoMap/">In√≠cio</a></li>
        <li><a href="http://localhost:1313/2025-2-OncoMap/sprints/">Sprints</a></li>
        <li><a href="#link-para-requisitos">Requisitos</a></li>
        <li><a href="#link-para-arquitetura">Arquitetura</a></li>
    </ul>

    <div class="navbar-right">
        <a href="https://github.com/unb-mds/2025-2-OncoMap" target="_blank">GitHub</a>
    </div>

</nav>

    <section class="hero">
    <div class="container">
        <h1>[FEATURE] Alimentacao do municipalities_status</h1>
        
        
        
        </div>
</section>

    <main>
        

    <div class="container page-single">
        <h1>[FEATURE] Alimentacao do municipalities_status</h1>
        
        <div class="content">
            <h2 id="-descri√ß√£o">üéØ Descri√ß√£o</h2>
<p>Criar e alimentar uma tabela de controle (<code>municipalities_status</code>) no banco de dados. Esta tabela servir√° como uma &ldquo;fila de processamento&rdquo;, contendo a lista de todos os 5.570 munic√≠pios do Brasil e o status de sua coleta de dados (se j√° foi processado ou n√£o).</p>
<hr>
<h2 id="-objetivo">‚úÖ Objetivo</h2>
<p>O problema que esta feature resolve √© a falta de resili√™ncia e estado do nosso script de coleta de dados em larga escala (<code>collector.js</code>). Atualmente, se o processo de coleta (que leva dias) for interrompido por qualquer motivo (queda de internet, desligamento do computador), ele precisa recome√ßar do zero, desperdi√ßando tempo e recursos.</p>
<p>Esta funcionalidade √© crucial porque transforma nosso coletor em um processo <strong>robusto, resiliente e reinici√°vel</strong>. Com a tabela de status, o script saber√° exatamente onde parou e poder√° continuar do pr√≥ximo munic√≠pio pendente, garantindo a integridade da nossa carga de dados inicial sem retrabalho.</p>
<hr>
<h2 id="-detalhes-da-implementa√ß√£o">üìù Detalhes da Implementa√ß√£o</h2>
<p>A implementa√ß√£o ser√° focada em um novo script de setup e na cria√ß√£o da tabela de suporte no banco de dados.</p>
<ul>
<li>
<p><strong>Cria√ß√£o da Tabela no Banco de Dados:</strong></p>
<ul>
<li>No Supabase (ou no cliente de banco de dados), criar uma nova tabela chamada <code>municipalities_status</code> com as seguintes colunas:
<ul>
<li><code>ibge_code</code> (VARCHAR(7), PRIMARY KEY)</li>
<li><code>name</code> (VARCHAR(255), NOT NULL)</li>
<li><code>state_uf</code> (VARCHAR(2), NOT NULL)</li>
<li><code>last_processed_at</code> (TIMESTAMP WITH TIME ZONE, NULL)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Cria√ß√£o do Script de Setup:</strong></p>
<ul>
<li>Criar um novo script <code>backend/scripts/setup_municipalities.js</code>.</li>
<li>Este script ir√°:
<ol>
<li>Ler o arquivo <code>src/data/municipios.json</code> que cont√©m a lista de todos os munic√≠pios.</li>
<li>Fazer um loop por cada munic√≠pio no arquivo JSON.</li>
<li>Para cada munic√≠pio, inserir uma nova linha na tabela <code>municipalities_status</code>, com o <code>last_processed_at</code> definido como <code>NULL</code>.</li>
</ol>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-crit√©rios-de-aceita√ß√£o">üìä Crit√©rios de Aceita√ß√£o</h2>
<p>Para considerar esta funcionalidade conclu√≠da, os seguintes pontos devem ser atendidos:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> A tabela <code>municipalities_status</code> existe no banco de dados com a estrutura correta.</li>
<li><input checked="" disabled="" type="checkbox"> O script <code>setup_municipalities.js</code> √© criado e est√° funcional.</li>
<li><input checked="" disabled="" type="checkbox"> Ao executar o script de setup, a tabela <code>municipalities_status</code> √© populada com sucesso com todos os 5.570 munic√≠pios.</li>
<li><input checked="" disabled="" type="checkbox"> Todas as novas linhas na tabela <code>municipalities_status</code> s√£o inseridas com a coluna <code>last_processed_at</code> como <code>NULL</code>.</li>
<li><input checked="" disabled="" type="checkbox"> O script pode ser executado novamente sem gerar erros de duplicidade (gra√ßas √† cl√°usula <code>ON CONFLICT</code>).</li>
<li><input checked="" disabled="" type="checkbox"> O comando <code>npm run db:setup</code> est√° configurado no <code>package.json</code> e executa o script corretamente.</li>
</ul>
<hr>

        </div>
    </div>


    </main>

    <footer class="footer">
    <div class="container">
        <div class="footer-grid">
            
            <div class="footer-column about">
                <h3>OncoMap</h3>
                <p>Mapa de investimento em sa√∫de oncol√≥gica</p>
            </div>
            
            <div class="footer-column links">
                <h3>Links √öteis</h3>
                <ul>
                    <li><a href="http://localhost:1313/2025-2-OncoMap/">In√≠cio</a></li>
                    <li><a href="http://localhost:1313/2025-2-OncoMap/sprints">Sprints</a></li>
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
            
            <div class="footer-column contact">
                <h3>Contato</h3>
                <ul>
                    <li><a href="https://github.com/unb-mds/2025-2-OncoMap" target="_blank">GitHub</a></li>
                </ul>
            </div>

        </div>
    </div>
    
    <div class="footer-bottom">
        <div class="container">
            <p>&copy; 2025 OncoMap. Todos os direitos reservados.</p>
            <p>Desenvolvido pela equipe UnB-MDS</p>
        </div>
    </div>
</footer>
    
    <script src="http://localhost:1313/2025-2-OncoMap/js/app.js"></script>
</body>
</html>